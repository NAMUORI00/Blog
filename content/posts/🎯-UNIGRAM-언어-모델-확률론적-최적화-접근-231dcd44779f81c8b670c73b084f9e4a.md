---
title: "ğŸ¯ UNIGRAM ì–¸ì–´ ëª¨ë¸ - í™•ë¥ ë¡ ì  ìµœì í™” ì ‘ê·¼"
date: "2025-07-15T04:11:00.000Z"
lastmod: "2025-07-23T06:20:00.000Z"
draft: false
series: []
tags: []
categories: []
authors:
  - "KYS"
NOTION_METADATA:
  object: "page"
  id: "231dcd44-779f-81c8-b670-c73b084f9e4a"
  created_time: "2025-07-15T04:11:00.000Z"
  last_edited_time: "2025-07-23T06:20:00.000Z"
  created_by:
    object: "user"
    id: "f96e6171-8ea1-4a4a-82e4-72ba4441b8c0"
  last_edited_by:
    object: "user"
    id: "f96e6171-8ea1-4a4a-82e4-72ba4441b8c0"
  cover: null
  icon: null
  parent:
    type: "database_id"
    database_id: "218dcd44-779f-81dd-bf93-e4fadbccbfde"
  archived: false
  in_trash: false
  properties:
    series:
      id: "B%3C%3FS"
      type: "multi_select"
      multi_select: []
    draft:
      id: "JiWU"
      type: "checkbox"
      checkbox: false
    authors:
      id: "bK%3B%5B"
      type: "people"
      people: []
    custom-front-matter:
      id: "c~kA"
      type: "rich_text"
      rich_text: []
    tags:
      id: "jw%7CC"
      type: "multi_select"
      multi_select: []
    categories:
      id: "nbY%3F"
      type: "multi_select"
      multi_select: []
    Last edited time:
      id: "vbGE"
      type: "last_edited_time"
      last_edited_time: "2025-07-23T06:20:00.000Z"
    summary:
      id: "x%3AlD"
      type: "rich_text"
      rich_text: []
    Name:
      id: "title"
      type: "title"
      title:
        - type: "text"
          text:
            content: "ğŸ¯ UNIGRAM ì–¸ì–´ ëª¨ë¸ - í™•ë¥ ë¡ ì  ìµœì í™” ì ‘ê·¼"
            link: null
          annotations:
            bold: false
            italic: false
            strikethrough: false
            underline: false
            code: false
            color: "default"
          plain_text: "ğŸ¯ UNIGRAM ì–¸ì–´ ëª¨ë¸ - í™•ë¥ ë¡ ì  ìµœì í™” ì ‘ê·¼"
          href: null
  url: "https://www.notion.so/UNIGRAM-231dcd44779f81c8b670c73b084f9e4a"
  public_url: "https://namuori00.notion.site/UNIGRAM-231dcd44779f81c8b670c73b084f9e4a"
MANAGED_BY_NOTION_HUGO: true

---


# ğŸ¯ UNIGRAM ì–¸ì–´ ëª¨ë¸ - í™•ë¥ ë¡ ì  ìµœì í™” ì ‘ê·¼


## ê¸°ë³¸ ì² í•™ ë° íŒ¨ëŸ¬ë‹¤ì„ ì „í™˜


> **"ê° ì„œë¸Œì›Œë“œê°€ ë…ë¦½ì ìœ¼ë¡œ ìƒì„±ëœë‹¤ê³  ê°€ì •í•˜ê³ , ì „ì²´ ì‹œí€€ìŠ¤ì˜ í™•ë¥ ì„ ìµœëŒ€í™”í•˜ëŠ” ë¶„í• ì„ ì°¾ëŠ”ë‹¤"**


```javascript
BPEì˜ í•œê³„ ê·¹ë³µ:
BPE: íƒìš•ì  ë³‘í•© (ì§€ì—­ ìµœì í™”)
     â†“
UNIGRAM: ì „ì—­ í™•ë¥  ìµœì í™”
         í™•ë¥ ì  ë‹¤ì¤‘ ë¶„í•  ê³ ë ¤
         ì´ë¡ ì  ê·¼ê±° ìˆëŠ” ì ‘ê·¼
```


## ìˆ˜í•™ì  ê¸°ì´ˆ ì²´ê³„


### 1. ê¸°ë³¸ í™•ë¥  ëª¨ë¸


```javascript
ì£¼ì–´ì§„ ë¬¸ì¥ Së¥¼ í† í° ì‹œí€€ìŠ¤ x = (xâ‚, xâ‚‚, ..., xâ‚™)ë¡œ ë¶„í• í•  ë•Œ:

P(x) = âˆáµ¢â‚Œâ‚â¿ P(xáµ¢)

ì—¬ê¸°ì„œ:
â€¢ P(xáµ¢): í† í° xáµ¢ì˜ ë…ë¦½ í™•ë¥ 
â€¢ ê° í† í°ì€ ë‹¤ë¥¸ í† í°ê³¼ ë…ë¦½ì ìœ¼ë¡œ ìƒì„±
â€¢ ì „ì²´ í™•ë¥  = ê°œë³„ í™•ë¥ ì˜ ê³±
```


### 2. ìµœì í™” ëª©í‘œ í•¨ìˆ˜


```javascript
ëª©í‘œ: argmax P(x|S) = argmax âˆáµ¢â‚Œâ‚â¿ P(xáµ¢)

ë¡œê·¸ ë³€í™˜ (ìˆ˜ì¹˜ ì•ˆì •ì„±):
argmax âˆ‘áµ¢â‚Œâ‚â¿ log P(xáµ¢)

ì‹¤ì œ êµ¬í˜„:
L(x) = âˆ‘áµ¢â‚Œâ‚â¿ log P(xáµ¢) + Î» Ã— |x|

ì—¬ê¸°ì„œ:
â€¢ Î»: í† í° ê¸¸ì´ í˜ë„í‹° (ê³¼ë„í•œ ë¶„í•  ë°©ì§€)
â€¢ |x|: í† í° ì‹œí€€ìŠ¤ ê¸¸ì´
```


### 3. ë…ë¦½ì„± ê°€ì •ì˜ ì˜ë¯¸ì™€ í•¨ì˜


```javascript
ë…ë¦½ì„± ê°€ì •:
P(xáµ¢|xâ‚, ..., xáµ¢â‚‹â‚, xáµ¢â‚Šâ‚, ..., xâ‚™) = P(xáµ¢)

ì¥ì :
â€¢ ê³„ì‚° ë³µì¡ë„ ëŒ€í­ ê°ì†Œ
â€¢ ë³‘ë ¬ ì²˜ë¦¬ ê°€ëŠ¥
â€¢ ìˆ˜í•™ì  í•´ì„ ìš©ì´

ë‹¨ì :
â€¢ ë¬¸ë§¥ ì •ë³´ ë¬´ì‹œ
â€¢ ì¥ê±°ë¦¬ ì˜ì¡´ì„± ì†ì‹¤
â€¢ ì¡°ê±´ë¶€ í™•ë¥  ë¬´ì‹œ

ì™„í™” ë°©ë²•:
â€¢ Subword regularization ë„ì…
â€¢ Multiple segmentation ê³ ë ¤
â€¢ í™•ë¥ ì  ìƒ˜í”Œë§ í™œìš©
```


## BPE vs UNIGRAM íŒ¨ëŸ¬ë‹¤ì„ ë¹„êµ


| **ì¸¡ë©´**     | **BPE**             | **UNIGRAM**         |
| ---------- | ------------------- | ------------------- |
| **ì ‘ê·¼ ë°©ì‹**  | ë¹ˆë„ ê¸°ë°˜ ë³‘í•©            | í™•ë¥ ë¡ ì  ìµœì í™”            |
| **ë°©í–¥ì„±**    | Bottom-up (ë¬¸ìâ†’ë‹¨ì–´)   | Top-down (ì „ì²´â†’ë¶€ë¶„)    |
| **ê¸°ì¤€**     | ì§€ì—­ì  ë¹ˆë„ ìµœëŒ€í™”          | ì „ì—­ì  í™•ë¥  ìµœëŒ€í™”          |
| **ê³¼ì •**     | ê²°ì •ì  (deterministic) | í™•ë¥ ì  (probabilistic) |
| **ëª©í‘œ**     | íƒìš•ì  ì§€ì—­ ìµœì í™”          | ì´ë¡ ì  ì „ì—­ ìµœì í™” ì¶”êµ¬       |
| **ë¶„í•  ê²°ê³¼**  | ë‹¨ì¼ ê³ ì • ë¶„í•             | í™•ë¥  ë¶„í¬ë¡œ í‘œí˜„           |
| **ìˆ˜í•™ì  ê·¼ê±°** | íœ´ë¦¬ìŠ¤í‹±                | ì •ë³´ ì´ë¡  ê¸°ë°˜            |


## ğŸ”„ EM ì•Œê³ ë¦¬ì¦˜ì„ í†µí•œ í™•ë¥  ì¶”ì •


### EM ì•Œê³ ë¦¬ì¦˜ ê°œìš”


> **"ê´€ì°°ë˜ì§€ ì•Šì€ ì ì¬ ë³€ìˆ˜ê°€ ìˆëŠ” ìƒí™©ì—ì„œ ìµœëŒ€ ìš°ë„ ì¶”ì •ì„ ìˆ˜í–‰í•˜ëŠ” ë°˜ë³µ ì•Œê³ ë¦¬ì¦˜"**


```javascript
UNIGRAMì—ì„œì˜ ì ìš©:
ê´€ì°°ëœ ë°ì´í„°: ì›ì‹œ í…ìŠ¤íŠ¸ ë¬¸ì¥ë“¤
ì ì¬ ë³€ìˆ˜: ê° ë¬¸ì¥ì˜ ì˜¬ë°”ë¥¸ í† í° ë¶„í• 
ëª©í‘œ: í† í°ë³„ í™•ë¥  P(token) ì¶”ì •
```


### E-step (Expectation): ì‚¬í›„ í™•ë¥  ê³„ì‚°


**1. ìˆ˜í•™ì  ì •ì˜**


```javascript
í˜„ì¬ ëª¨ë¸ Î¸â½áµ—â¾ë¡œ ê° ë¬¸ì¥ì˜ ê°€ëŠ¥í•œ ë¶„í• ì— ëŒ€í•œ ì‚¬í›„ í™•ë¥  ê³„ì‚°:

P(segmentation|sentence, Î¸â½áµ—â¾) = 
    P(sentence|segmentation, Î¸â½áµ—â¾) Ã— P(segmentation|Î¸â½áµ—â¾) / Z

ì—¬ê¸°ì„œ:
â€¢ P(sentence|segmentation, Î¸â½áµ—â¾) = âˆáµ¢ P(tokenáµ¢|Î¸â½áµ—â¾)
â€¢ Z = âˆ‘â‚›â‚‘á—¨ P(sentence|seg, Î¸â½áµ—â¾) (ì •ê·œí™” ìƒìˆ˜)
```


**2. íš¨ìœ¨ì  êµ¬í˜„: Forward-Backward ì•Œê³ ë¦¬ì¦˜**


```python
def efficient_e_step(sentence, vocab, probs):
    """Dynamic Programmingì„ ì‚¬ìš©í•œ íš¨ìœ¨ì  E-step"""
    n = len(sentence)
    
    # Forward pass: Î±[i] = P(sentence[0:i]ì˜ ìµœì  ë¶„í• )
    alpha = [0.0] * (n + 1)
    alpha[0] = 1.0
    
    for i in range(1, n + 1):
        for j in range(i):
            substring = sentence[j:i]
            if substring in vocab:
                alpha[i] += alpha[j] * probs[substring]
    
    # Backward pass: Î²[i] = P(sentence[i:n]ì˜ ìµœì  ë¶„í• )
    beta = [0.0] * (n + 1)
    beta[n] = 1.0
    
    for i in range(n - 1, -1, -1):
        for j in range(i + 1, n + 1):
            substring = sentence[i:j]
            if substring in vocab:
                beta[i] += probs[substring] * beta[j]
    
    # ê° í† í°ì˜ ê¸°ëŒê°’ ê³„ì‚°
    expected_counts = defaultdict(float)
    for i in range(n):
        for j in range(i + 1, n + 1):
            substring = sentence[i:j]
            if substring in vocab:
                posterior = (alpha[i] * probs[substring] * beta[j]) / alpha[n]
                expected_counts[substring] += posterior
    
    return expected_counts
```


### M-step (Maximization): í™•ë¥  ì—…ë°ì´íŠ¸


```javascript
E-stepì—ì„œ ê³„ì‚°ëœ ê¸°ëŒ‘ê°’ì„ ì´ìš©í•´ í† í° í™•ë¥  ì—…ë°ì´íŠ¸:

Pâ½áµ—âºÂ¹â¾(tokenáµ¢) = Expected_count(tokenáµ¢) / Total_expected_count

ì—¬ê¸°ì„œ:
â€¢ Expected_count(tokenáµ¢): E-stepì—ì„œ ê³„ì‚°ëœ í† í° iì˜ ê¸°ëŒ¡ê°’
â€¢ Total_expected_count: ëª¨ë“  í† í°ì˜ ê¸°ëŒê°’ í•©
```


## âœ‚ï¸ ê°€ì§€ì¹˜ê¸° ê³¼ì •


### ê°€ì§€ì¹˜ê¸°ì˜ í•„ìš”ì„±ê³¼ ëª©í‘œ


```javascript
ì´ˆê¸° ë¬¸ì œ:
â€¢ ì‹œì‘ ì–´íœ˜: ëª¨ë“  ê°€ëŠ¥í•œ ì„œë¸ŒìŠ¤íŠ¸ë§ (100ë§Œê°œ+)
â€¢ ëª©í‘œ ì–´íœ˜: 32K í† í° (ë©”ëª¨ë¦¬/ì†ë„ ì œì•½)
â€¢ ë„ì „: ì„±ëŠ¥ ì†ì‹¤ ìµœì†Œí™”í•˜ë©° 97% ì–´íœ˜ ì¶•ì†Œ

í•µì‹¬ ì›ë¦¬:
"ì •ë³´ ì†ì‹¤ì´ ê°€ì¥ ì ì€ í† í°ë¶€í„° ìˆœì°¨ì ìœ¼ë¡œ ì œê±°"
```


### ì†ì‹¤ í•¨ìˆ˜ ê¸°ë°˜ ê°€ì§€ì¹˜ê¸°


```python
def calculate_likelihood_loss(sentences, vocab_without_token, current_probs):
    """íŠ¹ì • í† í° ì œê±° ì‹œ ìš°ë„ ì†ì‹¤ ê³„ì‚°"""
    total_loss = 0
    
    for sentence in sentences:
        # ì›ë˜ ìµœì  ë¶„í• 
        original_segmentation = find_best_segmentation(sentence, vocab_with_token, current_probs)
        original_logprob = sum(math.log(current_probs[token]) for token in original_segmentation)
        
        # í† í° ì œê±° í›„ ìµœì  ë¶„í• 
        new_segmentation = find_best_segmentation(sentence, vocab_without_token, current_probs)
        new_logprob = sum(math.log(current_probs[token]) for token in new_segmentation)
        
        # ì†ì‹¤ ëˆ„ì 
        total_loss += original_logprob - new_logprob
    
    return total_loss
```


### ê°€ì§€ì¹˜ê¸° ì „ëµë³„ ë¹„êµ


```javascript
1. ë¬´ì‘ìœ„ ì œê±°:
   â€¢ ì‹œê°„: ë§¤ìš° ë¹ ë¦„ (O(|V|))
   â€¢ ì„±ëŠ¥: ìµœì•… (-15% BLEU)
   â€¢ ì‚¬ìš©: ê¸°ì¤€ì„  ë¹„êµìš©

2. ë¹ˆë„ ê¸°ë°˜ ì œê±°:
   â€¢ ì‹œê°„: ë¹ ë¦„ (O(|V| log |V|))
   â€¢ ì„±ëŠ¥: ë‚˜ì¨ (-8% BLEU)
   â€¢ ë¬¸ì œ: í¬ê·€í•˜ì§€ë§Œ ì¤‘ìš”í•œ í† í° ì œê±°

3. ì†ì‹¤ ê¸°ë°˜ íƒìš•ì :
   â€¢ ì‹œê°„: ëŠë¦¼ (O(|V|Â² Ã— N))
   â€¢ ì„±ëŠ¥: ì¢‹ìŒ (-2% BLEU)
   â€¢ ì‚¬ìš©: ì¤‘ê°„ ê·œëª¨ ë°ì´í„°

4. ì ì‘ì  ì†ì‹¤ ê¸°ë°˜:
   â€¢ ì‹œê°„: ë³´í†µ (O(|V|^1.5 Ã— N))
   â€¢ ì„±ëŠ¥: ìµœê³  (-0.5% BLEU)
   â€¢ ì‚¬ìš©: ëŒ€ê·œëª¨ í”„ë¡œë•ì…˜

5. ê³„ì¸µì  ê°€ì§€ì¹˜ê¸°:
   â€¢ ë¹ˆë„ â†’ ì†ì‹¤ â†’ ë¯¸ì„¸ì¡°ì • ìˆœì„œ
   â€¢ ì†ë„ì™€ ì„±ëŠ¥ì˜ ê· í˜•
   â€¢ ê°€ì¥ ì‹¤ìš©ì ì¸ ì ‘ê·¼ë²•
```

